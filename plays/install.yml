---

- name: Check if namespace exists
  k8s_info:
    api_version: v1
    kind: Namespace
    name: "{{ dci_openshift_app_ns }}"
  register: app_namespace

- name: Create namespace
  k8s:
    api_version: v1
    kind: Namespace
    name: "{{ dci_openshift_app_ns }}"
    state: present
  when:
    - app_namespace.resources|length == 0

- name: Run helm install
  command: "/usr/local/bin/helm -n {{ dci_openshift_app_ns }} install instance {{ dci_chart_tgz_url }}"
  when: dci_chart_tgz_url is defined

...
